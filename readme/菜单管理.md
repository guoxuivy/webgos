# 前端菜单管理

## 1. 概述

菜单管理模块负责维护系统的前端导航菜单结构。菜单数据采用树形结构组织，支持多级嵌套，可以灵活配置菜单的显示、路由信息和页面组件。

需要注意的是，这里的菜单是指前端页面的导航菜单，与后端接口的RBAC权限系统没有直接关联。前端菜单主要用于控制页面导航的显示，而后端RBAC权限系统用于控制接口访问权限。

## 2. 菜单数据结构

### 2.1 菜单字段说明

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 菜单名称，需唯一 |
| path | string | 否 | 路由路径 |
| component | string | 否 | 前端组件路径 |
| type | string | 是 | 菜单类型：catalog-目录、menu-菜单、button-按钮、embedded-内嵌页面、link-外链 |
| status | int | 是 | 状态：0-禁用、1-启用 |
| meta | object | 是 | 菜单元数据 |
| pid | int | 否 | 父级菜单ID，用于构建层级关系 |

### 2.2 meta元数据字段说明

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| title | string | 是 | 菜单显示标题，支持国际化 |
| icon | string | 否 | 菜单图标，使用图标库标识 |
| affixTab | boolean | 否 | 是否固定标签页 |
| hideChildrenInMenu | boolean | 否 | 是否在菜单中隐藏子菜单 |
| hideInBreadcrumb | boolean | 否 | 是否在面包屑中隐藏 |
| hideInMenu | boolean | 否 | 是否在菜单中隐藏 |
| hideInTab | boolean | 否 | 是否在标签页中隐藏 |
| keepAlive | boolean | 否 | 是否保持活跃状态 |
| order | int | 否 | 排序权重，值越小越靠前 |
| badge | string | 否 | 徽标文本 |
| badgeType | string | 否 | 徽标类型 |
| badgeVariants | string | 否 | 徽标样式变体 |
| iframeSrc | string | 否 | iframe页面地址 |
| link | string | 否 | 外链地址 |

## 3. 菜单类型说明

### 3.1 目录类型 (catalog)
目录类型菜单作为菜单分组使用，不对应具体页面，主要用于组织下级菜单项。

示例：
```json
{
  "name": "System1",
  "path": "/system",
  "type": "catalog",
  "status": 1,
  "meta": {
    "title": "system.title",
    "icon": "carbon:settings",
    "badgeType": "normal",
    "badge": "new",
    "badgeVariants": "primary",
    "order": 9997
  }
}
```

### 3.2 菜单类型 (menu)
指向系统内部页面的菜单项，需要指定component字段。

示例：
```json
{
  "name": "SystemMenu1",
  "path": "/system/menu",
  "type": "menu",
  "status": 1,
  "pid": 2,
  "meta": {
    "title": "system.menu.title",
    "icon": "carbon:menu"
  },
  "component": "/system/menu/list",
  "authCode": "System:Menu:List"
}
```

### 3.3 按钮类型 (button)
按钮类型菜单不显示在导航菜单中，主要用于页面内按钮的权限控制。

示例：
```json
{
  "name": "SystemDeptEdit1",
  "path": "",
  "type": "button",
  "status": 1,
  "pid": 201,
  "meta": {
    "title": "common.edit"
  },
  "authCode": "System:Dept:Edit"
}
```

### 3.4 内嵌类型 (embedded)
内嵌类型菜单用于在系统内部嵌入外部网页，通过iframe展示。

示例：
```json
{
  "name": "VbenDocument1",
  "path": "/vben-admin/document",
  "type": "embedded",
  "status": 1,
  "pid": 9,
  "meta": {
    "title": "demos.vben.document",
    "icon": "carbon:book",
    "iframeSrc": "https://doc.vben.pro"
  },
  "component": "IFrameView"
}
```

### 3.5 外链类型 (link)
外链类型菜单用于跳转到外部链接。

示例：
```json
{
  "name": "VbenGithub1",
  "path": "/vben-admin/github",
  "type": "link",
  "status": 1,
  "pid": 9,
  "meta": {
    "title": "Github",
    "icon": "carbon:logo-github",
    "link": "https://github.com/vbenjs/vue-vben-admin"
  },
  "component": "IFrameView"
}
```

## 4. 菜单状态管理

### 4.1 状态值定义
- 0: 禁用 - 菜单不会在导航中显示
- 1: 启用 - 菜单正常显示在导航中

### 4.2 状态控制
菜单状态可实时切换，切换后立即生效，无需重启服务。

## 5. 菜单与后端权限系统的关系

### 5.1 区别说明
前端菜单系统与后端RBAC权限系统是两个独立的系统：
- **前端菜单系统**：控制导航菜单的显示与页面路由，与用户界面相关
- **后端RBAC权限系统**：控制接口访问权限，与业务逻辑安全相关

### 5.2 关系说明
虽然两个系统没有直接关联，但在实际应用中可能存在间接关系：
- 前端页面中的某些操作可能需要调用后端接口
- 这些接口的访问权限由后端RBAC系统控制
- 前端可以根据用户的权限信息动态显示或隐藏某些菜单项

## 6. 菜单层级

系统支持无限层级菜单嵌套：
- 通过pid字段建立父子关系
- 顶层菜单pid为0或null
- 建议层级不超过4级，以保证用户体验

## 7. 菜单与路由的关系

### 7.1 自动同步机制

系统实现了基于路由的菜单项自动生成机制：
1. 在路由注册时，通过封装的RouterWrapper收集路由信息
2. 系统启动时，将收集到的路由信息同步到数据库作为权限点
3. 如果权限点已存在，则更新其描述信息；如果不存在，则创建新权限点

### 7.2 路径处理规范

- 所有路径统一转换为小写
- 去除重复的斜杠
- 保持路径结构清晰

## 8. 新增元数据字段说明

### 8.1 hideChildrenInMenu
控制是否在菜单中隐藏子菜单项。当设置为true时，子菜单将不会在导航菜单中显示。

### 8.2 hideInBreadcrumb
控制是否在面包屑导航中隐藏该菜单项。当设置为true时，该菜单项不会出现在面包屑导航中。

### 8.3 hideInMenu
控制是否在菜单中完全隐藏该菜单项。当设置为true时，该菜单项不会在导航菜单中显示。

### 8.4 hideInTab
控制是否在标签页中隐藏该菜单项。当设置为true时，该菜单项不会在标签页中显示。

### 8.5 keepAlive
控制页面是否保持活跃状态。当设置为true时，在前端路由切换时不会重新加载页面。

## 9. 最佳实践

### 9.1 菜单设计原则

1. **清晰性**：菜单结构应清晰明了，便于用户理解
2. **一致性**：保持菜单项命名和图标风格统一
3. **可维护性**：合理划分菜单层级，避免过深的嵌套
4. **安全性**：确保每个菜单项都关联了适当的权限控制

### 9.2 菜单配置建议

1. 根据业务功能模块合理划分菜单结构
2. 为不同类型的用户角色配置不同的菜单显示
3. 定期审查和清理无用的菜单项
4. 保持菜单结构的简洁性和易用性